<!DOCTYPE html>
<html lang="ko">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Card Navi - ì¹´ë“œ ì¶”ì²œ ì‹œìŠ¤í…œ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh; color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
        .header { text-align: center; margin-bottom: 3rem; }
        .logo { font-size: 3.5rem; font-weight: 700; color: white; text-shadow: 0 4px 8px rgba(0,0,0,0.3); margin-bottom: 1rem; }
        .subtitle { color: rgba(255,255,255,0.9); font-size: 1.2rem; }
        .main-card {
            background: rgba(255,255,255,0.95); border-radius: 20px; padding: 3rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); backdrop-filter: blur(10px);
        }
        .section-title { font-size: 1.8rem; font-weight: 600; color: #2c3e50; margin-bottom: 2rem; text-align: center; }
        .selection-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .selection-item { background: #f8f9fa; padding: 1.5rem; border-radius: 15px; border-left: 4px solid #667eea; }
        .selection-label { font-weight: 600; color: #495057; margin-bottom: 1rem; }
        select {
            width: 100%; padding: 1rem; border: 2px solid #e9ecef; border-radius: 12px;
            font-size: 1rem; font-weight: 600; background: white;
        }
        .search-section { text-align: center; margin: 2rem 0; }
        .search-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white; border: none; padding: 1rem 3rem; font-size: 1.1rem;
            border-radius: 50px; cursor: pointer;
        }
        .action-button {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white; border: none; padding: 0.8rem 2rem; font-size: 1rem;
            font-weight: 600; border-radius: 25px; cursor: pointer;
            margin: 1rem 0;
        }
        .results-card {
            background: #fff; border-radius: 15px; padding: 1rem; margin-bottom: 1rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        .results-card img { max-width: 150px; display: block; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 class="logo">Card Navi</h1>
            <p class="subtitle">ë§ì¶¤í˜• ì¹´ë“œ ì¶”ì²œ ì‹œìŠ¤í…œ</p>
        </header>
        <main class="main-card">
            <h2 class="section-title">ì§€ì—­êµ¬, ì„±ë³„, ì—°ë ¹ëŒ€ ì„ íƒ í›„ ê²€ìƒ‰ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ì„¸ìš”</h2>
            <div class="selection-grid">
                <div class="selection-item">
                    <div class="selection-label">ì§€ì—­êµ¬ ì„ íƒ</div>
                    <select id="region">
                        <option value="Gwan">ê¶Œì„ êµ¬</option>
                        <option value="Young">ì˜í†µêµ¬</option>
                        <option value="Jang">ì¥ì•ˆêµ¬</option>
                        <option value="Pal">íŒ”ë‹¬êµ¬</option>
                    </select>
                </div>
                <div class="selection-item">
                    <div class="selection-label">ì„±ë³„ ì„ íƒ</div>
                    <select id="sex">
                        <option value="M">ë‚¨ì„±</option>
                        <option value="F">ì—¬ì„±</option>
                    </select>
                </div>
                <div class="selection-item">
                    <div class="selection-label">ì—°ë ¹ ì„ íƒ</div>
                    <select id="age">
                        <option value="20s">20ëŒ€</option>
                        <option value="30s">30ëŒ€</option>
                        <option value="40s">40ëŒ€</option>
                        <option value="50s">50ëŒ€</option>
                        <option value="60s">60ëŒ€</option>
                        <option value="70s">70ëŒ€</option>
                        <option value="80s">80ëŒ€</option>
                        <option value="90s">90ëŒ€</option>
                    </select>
                </div>
            </div>
            <div class="search-section">
                <button class="search-button" onclick="showOptions()">ğŸ” ê²€ìƒ‰í•˜ê¸°</button>
            </div>
            <div id="resultContainer" class="dynamic-content"></div>
        </main>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script>
        let cardData = [];
        const subCategoryMap = {
            "ê³µì—°/ì „ì‹œ": ["ê³µì—°ê´€ëŒ", "ë¬¸í™”ì„œë¹„ìŠ¤", "ì „ì‹œì¥", "ê²½ê¸°ê´€ëŒ"],
            "ë””ì €íŠ¸": ["ì œê³¼/ì œë¹µ/ë–¡/ì¼€ìµ", "ì»¤í”¼/ìŒë£Œ"],
            "ìƒí™œì„œë¹„ìŠ¤": ["ë¯¸ìš©ì„œë¹„ìŠ¤", "ì„¸íƒ/ê°€ì‚¬ì„œë¹„ìŠ¤", "ì—°ë£ŒíŒë§¤", "ì°¨ëŸ‰ê´€ë¦¬/ì„œë¹„ìŠ¤", "ë³´ì•ˆ/ìš´ì†¡", "ë¬´ì í¬ì„œë¹„ìŠ¤", "ì‚¬ìš°ë‚˜/íœ´ê²Œì‹œì„¤", "ìˆ˜ë¦¬ì„œë¹„ìŠ¤", "ë Œíƒˆì„œë¹„ìŠ¤", "êµí†µì„œë¹„ìŠ¤", "ì „ë¬¸ì„œë¹„ìŠ¤", "ì—¬í–‰/ìœ í•™ëŒ€í–‰", "ë¶€ë™ì‚°"],
            "ì†Œë§¤/ìœ í†µ": ["ê±´ê°•/ê¸°í˜¸ì‹í’ˆ", "ì‚¬ë¬´/êµìœ¡ìš©í’ˆ", "ì„œì /ë„ì„œ", "ì„ ë¬¼/ì™„êµ¬", "ìŠ¤í¬ì¸ /ë ˆì ¸ìš©í’ˆ", "ìŒ/ì‹ë£Œí’ˆì†Œë§¤", "ì˜ë³µ/ì˜ë¥˜", "ì¸í…Œë¦¬ì–´/ê°€ì •ìš©í’ˆ", "ì¢…í•©ì†Œë§¤ì ", "ì°¨ëŸ‰ê´€ë¦¬/ë¶€í’ˆ", "ì•…ê¸°/ê³µì˜ˆ", "íŒ¨ì…˜ì¡í™”", "í™”ì¥í’ˆì†Œë§¤", "ì°¨ëŸ‰íŒë§¤", "ê°€ì „ì œí’ˆ", "ìœ ì•„ìš©í’ˆ"],
            "ì‹ì‚¬": ["ê³ ê¸°ìš”ë¦¬", "ë‹­/ì˜¤ë¦¬ìš”ë¦¬", "ë³„ì‹/í“¨ì „ìš”ë¦¬", "ë¶€í˜", "ë¶„ì‹", "ì–‘ì‹", "ì¼ì‹/ìˆ˜ì‚°ë¬¼", "ì¤‘ì‹", "íŒ¨ìŠ¤íŠ¸í‘¸ë“œ", "í•œì‹", "íœ´ê²Œì†Œ/ëŒ€í˜•ì—…ì²´"],
            "ì—¬ê°€/ì˜¤ë½": ["ìˆ™ë°•", "ì¼ë°˜ìŠ¤í¬ì¸ ", "ì·¨ë¯¸/ì˜¤ë½", "ìš”ê°€/ë‹¨ì „/ë§ˆì‚¬ì§€"],
            "ì˜ë£Œ/ê±´ê°•": ["ìˆ˜ì˜ì—…", "ì˜ì•½/ì˜ë£Œí’ˆ", "ì¼ë°˜ë³‘ì›", "íŠ¹í™”ë³‘ì›", "ì¢…í•©ë³‘ì›"],
            "ì „ììƒê±°ë˜": ["ì¸í„°ë„·ì‡¼í•‘", "ìŒì‹ë°°ë‹¬ì„œë¹„ìŠ¤"]
        };

        fetch('final_web.csv')
          .then(res => res.text())
          .then(text => {
              const parsed = Papa.parse(text, { header: true });
              cardData = parsed.data;
          });

        function showOptions() {
            const container = document.getElementById("resultContainer");
            container.innerHTML = "";

            Object.keys(subCategoryMap).forEach(cat => {
                const box = document.createElement("div");
                box.innerHTML = `<label><input type="checkbox" name="recommended" value="${cat}"> ${cat}</label>`;
                container.appendChild(box);
            });

            const subBtn = document.createElement("button");
            subBtn.className = "action-button";
            subBtn.textContent = "ì†Œë¶„ë¥˜ ê²€ìƒ‰";
            subBtn.onclick = showSubCategories;
            container.appendChild(subBtn);

            const cardBtn = document.createElement("button");
            cardBtn.className = "action-button";
            cardBtn.textContent = "ì¹´ë“œ ê²€ìƒ‰";
            cardBtn.onclick = searchCards;
            container.appendChild(cardBtn);
        }

        function showSubCategories() {
            const selected = Array.from(document.querySelectorAll('input[name="recommended"]:checked')).map(el => el.value);
            const container = document.getElementById("resultContainer");
            container.innerHTML = "";

            selected.forEach(cat => {
                const subList = subCategoryMap[cat] || [];
                const group = document.createElement("div");
                group.innerHTML = `<strong>${cat}</strong><br>` +
                    subList.map(sub => `<label><input type="checkbox" name="subcategory" value="${sub}"> ${sub}</label>`).join(" ");
                container.appendChild(group);
            });

            const cardBtn = document.createElement("button");
            cardBtn.className = "action-button";
            cardBtn.textContent = "ì¹´ë“œ ê²€ìƒ‰";
            cardBtn.onclick = searchCards;
            container.appendChild(cardBtn);
        }

        function searchCards() {
            const bigSel = Array.from(document.querySelectorAll('input[name="recommended"]:checked')).map(el => el.value);
            const subSel = Array.from(document.querySelectorAll('input[name="subcategory"]:checked')).map(el => el.value);

            if (bigSel.length === 0 && subSel.length === 0) {
                alert("ëŒ€ë¶„ë¥˜ë‚˜ ì†Œë¶„ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”!");
                return;
            }

            const results = cardData.filter(card => {
                try {
                    const bigTags = JSON.parse(card['ëŒ€ë¶„ë¥˜íƒœê·¸'].replace(/'/g, '"'));
                    const smallTags = JSON.parse(card['ì†Œë¶„ë¥˜íƒœê·¸'].replace(/'/g, '"'));
                    return bigSel.some(cat => bigTags.includes(cat)) || subSel.some(sub => smallTags.includes(sub));
                } catch(e) {
                    return false;
                }
            });

            displayCardResults(results);
        }

        function displayCardResults(cards) {
            const container = document.getElementById("resultContainer");
            container.innerHTML = "";

            if (cards.length === 0) {
                container.innerHTML = "<p>ì¡°ê±´ì— ë§ëŠ” ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
                return;
            }

            cards.forEach(c => {
                const cardEl = document.createElement("div");
                cardEl.className = "results-card";
                cardEl.innerHTML = `
                    <img src="${c['ì´ë¯¸ì§€ URL']}" alt="${c['ì¹´ë“œëª…']}">
                    <h4>${c['ì¹´ë“œëª…']}</h4>
                    <p><strong>í˜œíƒ:</strong> ${c['í†µí•©í˜œíƒ']}</p>
                    <p><strong>ì—…ì¢…:</strong> ${c['ëŒ€ë¶„ë¥˜íƒœê·¸']} / ${c['ì†Œë¶„ë¥˜íƒœê·¸']}</p>
                    <a href="${c['ì¹´ë“œ ë””í…Œì¼ ë§í¬']}" target="_blank">ìì„¸íˆ ë³´ê¸°</a>
                `;
                container.appendChild(cardEl);
            });
        }
    </script>
</body>
</html>
